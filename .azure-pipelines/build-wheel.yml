parameters:
  jobs: []

jobs:
- ${{ each job in parameters.jobs }}: # Each job
  - ${{ each pair in job }}:          # Insert all properties other than "steps"
      ${{ if ne(pair.key, 'steps') }}:
        ${{ pair.key }}: ${{ pair.value }}
    displayName: ${{ job.displayName }}
    pool:
      vmImage: ${{ job.image }}
    steps:                            # Wrap the steps
    - checkout: self
      submodules: true
      clean: true

    - task: UsePythonVersion@0
      inputs:
        versionSpec: ${{ job.python }}
      displayName: "Use Python ${{ job.python }}"


    - script: |
        pip install -U setuptools wheel
      displayName: "Install tools"

    - ${{ job.steps }}                # Users steps

    - task: PublishBuildArtifacts@1
      displayName: "Publish distribution"
      inputs:
        pathtoPublish: 'dist'
        artifactName: dist

