jobs:
- job: 'Flake8'
  pool:
    vmImage: 'ubuntu-latest'

  steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: "3.7"
      architecture: "x64"

  - script: |
      pip install -r requirements/lint.txt
    displayName: "Install deps"

  - script: |
      make flake8
    displayName: "Run flake8"

- job: 'Black'
  pool:
    vmImage: 'ubuntu-latest'

  steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: "3.7"
      architecture: "x64"

  - script: |
      pip install -r requirements/lint.txt
    displayName: "Install deps"

  - script: |
      make black-check
    displayName: "Run black checker"

- job: 'MyPy'
  pool:
    vmImage: 'ubuntu-latest'

  steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: "3.7"
      architecture: "x64"

  - script: |
      pip install -r requirements/lint.txt
    displayName: "Install deps"

  - script: |
      pip install -e .
    displayName: "Install itself"
    env:
      YARL_NO_EXTENSIONS: 1

  - script: |
      make mypy
    displayName: "Run black checker"

- job: 'Docs'
  pool:
    vmImage: 'ubuntu-latest'

  steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: "3.7"
      architecture: "x64"

  - script: |
      apt install libenchant-dev
      pip install -r requirements/doc-spelling.txt
    displayName: "Install deps"

  - script: |
      make doc
    displayName: "Run docs checker"
    env:
      YARL_NO_EXTENSIONS: 1

- job: 'Twine Checker'
  pool:
    vmImage: 'ubuntu-latest'

  steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: "3.7"
      architecture: "x64"

  - script: |
      pip install -U twine
      make sdist bdist_wheel
    displayName: "Install deps"
    env:
      YARL_NO_EXTENSIONS: 1

  - script: |
      twine check dist
    displayName: "Run twine checker"
