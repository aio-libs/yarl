Improved performance of handling ports -- by :user:`bdraco`.
